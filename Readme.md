# SecureSuite: Multi-Layered Software Security Analyzer

## Overview
SecureSuite is an integrated security analysis tool designed to evaluate various security aspects of software systems. Built for educational and professional use, it includes individual services for phishing detection, vulnerability scanning, extension permission analysis, and static code analysis.

This project was developed as a part of the CSE 279 - Software Security graduate course. It aims to demonstrate practical applications of security principles by scanning real-world inputs and identifying potential threats.

---

## Table of Contents
- [Project Structure](#project-structure)
- [Features](#features)
- [Installation](#installation)
- [Running the Application](#running-the-application)
- [API Documentation](#api-documentation)
- [Test Files](#test-files)
- [Security Techniques Used](#security-techniques-used)
- [Analyzer Logic Explanation](#analyzer-logic-explanation)
- [Future Improvements](#future-improvements)

---

## Project Structure
```
SECUSITE-BACKEND/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ routes/                   # API route declarations
‚îÇ   ‚îú‚îÄ‚îÄ services/                 # Logic for phishing, vuln scan, etc.
‚îÇ   ‚îú‚îÄ‚îÄ utils/                    # Utility files (if needed)
‚îÇ   ‚îî‚îÄ‚îÄ main.py                  # FastAPI application entry point
‚îú‚îÄ‚îÄ testfiles/                   # Sample files to test APIs
‚îú‚îÄ‚îÄ tests/                       # (Optional) Unit tests
‚îú‚îÄ‚îÄ requirements.txt             # Python dependencies
‚îú‚îÄ‚îÄ run.py                       # Script to run the app (optional)
‚îî‚îÄ‚îÄ README.md                    # This file
```

---

## Features
### 1. **Phishing Detection**
- Analyzes email headers (from `.eml` files)
- Detects suspicious patterns:
  - `From` vs `Reply-To` mismatch
  - Missing `Received` headers

### 2. **Vulnerability Scanning**
- Analyzes `requirements.txt` files
- Uses Google OSV API to check for known CVEs
- Returns vulnerable package list with summaries

### 3. **Extension Analysis**
- Accepts `.zip` Chrome extensions (renamed from `.crx`)
- Extracts `manifest.json`
- Flags risky permissions such as `webRequest`, `tabs`, etc.
- Returns a risk score: `low`, `medium`, or `high`

### 4. **Static Code Analysis**
- Scans `.py` files for simple dangerous patterns (e.g., `eval`, hardcoded secrets)
- Flags lines that may pose a security risk

---

## Installation
```bash
# Clone the repo
$ git clone https://github.com/akshat235/secsuite-backend.git
$ cd secsuite-backend

# Create and activate virtual environment (optional)
$ python -m venv venv
$ source venv/bin/activate  # or venv\Scripts\activate on Windows

# Install dependencies
$ pip install -r requirements.txt
```

---

## Running the Application
```bash
# Run using uvicorn
$ uvicorn app.main:app --reload

# Visit Swagger UI
http://127.0.0.1:8000/docs
```

---

## API Documentation
Auto-generated by FastAPI using Swagger:

### `/phishing/`
- Method: `POST`
- Request: `.eml` file
- Response:
```json
{
  "phishing_analysis": {
    "phishing": true,
    "risk_score": 1,
    "flags": ["From and Reply-To domains mismatch"]
  }
}
```

### `/vulnerability/`
- Method: `POST`
- Request: `.txt` (requirements.txt format)
- Response:
```json
{
  "vulnerability_report": [
    {
      "package": "flask",
      "version": "1.1.1",
      "vulnerabilities": [
        {
          "id": "PYSEC-2022-123",
          "summary": "...",
          "introduced": "1.1.0",
          "fixed": "1.1.2"
        }
      ]
    }
  ]
}
```

### `/extension/`
- Method: `POST`
- Request: `.zip` file (Chrome extension)
- Response:
```json
{
  "permissions": ["tabs", "webRequest"],
  "risky_permissions": ["tabs", "webRequest"],
  "risk_level": "medium"
}
```

### `/static/`
- Method: `POST`
- Request: `.py` file
- Response:
```json
{
  "risks": ["Line 3: Use of eval()", "Line 12: Hardcoded password"]
}
```

---

## Test Files
- `testfiles/test_phishing.eml`: Simulates phishing headers
- `testfiles/test_vulnerability.txt`: Contains old vulnerable packages
- `testfiles/test_extension.zip`: Chrome extension with suspicious permissions
- `testfiles/test_static_analysis.py`: Script with vulnerable code patterns

---

## Security Techniques Used
- Heuristic header analysis (phishing)
- Integration with CVE database (vulnerability)
- Static analysis using regex patterns (code scan)
- Permission-based risk scoring (browser extensions)

---

## Analyzer Logic Explanation

### üõ°Ô∏è Phishing Detection
- Parses the email header to extract `From` and `Reply-To` addresses.
- Compares domain parts of these two headers to detect spoofing.
- If a `Return-Path` exists but there‚Äôs no `Received` header, it‚Äôs flagged as suspicious.
- Scores are based on number of red flags detected.

### üß™ Vulnerability Scanning
- Reads each package and version from a `requirements.txt` file.
- Queries the [OSV.dev API](https://osv.dev) for known vulnerabilities.
- Checks if the specified version falls within an "introduced" to "fixed" range.
- Returns vulnerabilities with summaries and CVE IDs.

### üß© Extension Analysis
- Accepts `.zip` Chrome extensions and extracts `manifest.json`.
- Reads declared `permissions` field.
- Compares against a list of known risky permissions (`webRequest`, `tabs`, etc).
- Assigns a risk level:
  - `low`: 0 risky permissions
  - `medium`: 1‚Äì2 risky permissions
  - `high`: 3 or more risky permissions

### üîç Static Code Analysis
- Scans `.py` files line-by-line.
- Uses simple pattern matching for:
  - `eval()` usage
  - Hardcoded credentials (e.g., password = ...)
  - Unsafe functions (e.g., `os.system`, `subprocess.call`)
- Returns a list of flagged lines with contextual risk descriptions.

---


## Future Improvements
- Add authentication to the API
- Implement CVSS-based scoring for vulnerabilities
- Use ML models for phishing classification
- Expand static code analysis with AST parsing
